"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3843,8406],{8794:(e,t,s)=>{s.d(t,{A:()=>d,AuthProvider:()=>c});var n=s(95155),i=s(12115),l=s(93004),o=s(35317),a=s(13843);let r=(0,i.createContext)({user:null,login:async()=>{throw Error("Not implemented")},signup:async()=>{throw Error("Not implemented")},logout:async()=>{throw Error("Not implemented")},loading:!0});function c(e){let{children:t}=e,[s,c]=(0,i.useState)(null),[d,u]=(0,i.useState)(!0);(0,i.useEffect)(()=>{let e=(0,l.hg)(a.auth,e=>{c(e),u(!1)});return()=>e()},[]);let m=async(e,t)=>{try{let s=await (0,l.x9)(a.auth,e,t);return c(s.user),localStorage.setItem("last-login-email",e),s.user}catch(e){throw console.error("Login error:",e.code,e.message),e}},x=async(e,t,s)=>{try{let n=(await (0,l.eJ)(a.auth,t,s)).user;return await (0,l.r7)(n,{displayName:e}),await (0,o.BN)((0,o.H9)(a.db,"users",n.uid),{uid:n.uid,displayName:e,email:t,createdAt:new Date().toISOString()}),c(n),n}catch(e){throw console.error("Signup error:",e.code,e.message),e}},g=async()=>{try{await (0,l.CI)(a.auth),c(null)}catch(e){throw console.error("Logout error:",e.code,e.message),e}};return(0,n.jsx)(r.Provider,{value:{user:s,login:m,signup:x,logout:g,loading:d},children:t})}let d=()=>(0,i.useContext)(r)},13843:(e,t,s)=>{let n;s.d(t,{auth:()=>a,db:()=>r});var i=s(23915),l=s(93004),o=s(35317);n=(0,i.Dk)().length?(0,i.Dk)()[0]:(0,i.Wp)({apiKey:"AIzaSyCUXDjtCkalFKkukgedZePOySwYLimkakM",authDomain:"new-awv-app.firebaseapp.com",projectId:"new-awv-app",storageBucket:"new-awv-app.firebasestorage.app",messagingSenderId:"466832878",appId:"1:466832878:web:504bb7a0b7de0705cad2ff"});let a=(0,l.xI)(n),r=(0,o.aU)(n)},39109:(e,t,s)=>{s.d(t,{A:()=>b});var n=s(95155),i=s(12115),l=s(62177),o=s(85037),a=s(14926),r=s(31151),c=s(52108),d=s(90621);let u=e=>{let{question:t,activeSection:s,questionIndex:l,setValue:a}=e,[c,u]=(0,i.useState)(null),[m,x]=(0,i.useState)(null),[g,p]=(0,i.useState)({text:"",category:"Preventive Care"}),b=["Preventive Care","Lifestyle","Exercise","Nutrition","Follow-up","Medication","Mental Health","Specialist Referral","Screenings","Other"];if(["RADIO","SELECT","MULTISELECT","CHECKBOX"].includes(t.type))return(0,n.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Options"}),(0,n.jsxs)("div",{className:"space-y-3",children:[(t.options||[]).map((e,i)=>{var h;return(0,n.jsxs)("div",{className:"flex flex-col space-y-2 p-3 border border-gray-200 rounded-md",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"text",value:e.text,onChange:e=>{let n=[...t.options||[]];n[i]={...n[i],text:e.target.value,value:e.target.value.toLowerCase().replace(/\s+/g,"_")},a("sections.".concat(s,".questions.").concat(l,".options"),n)},className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded-md",placeholder:"Option ".concat(i+1)}),(0,n.jsx)("button",{type:"button",onClick:()=>{let e=(t.options||[]).filter((e,t)=>t!==i);a("sections.".concat(s,".questions.").concat(l,".options"),e)},className:"ml-2 text-red-600 hover:text-red-800",children:(0,n.jsx)(r.A,{className:"h-4 w-4"})})]}),(0,n.jsx)("button",{type:"button",onClick:()=>{u(c==="".concat(s,"-").concat(l,"-").concat(i)?null:"".concat(s,"-").concat(l,"-").concat(i))},className:"text-xs text-blue-600 hover:text-blue-800 text-left flex items-center",children:c==="".concat(s,"-").concat(l,"-").concat(i)?"Hide Recommendations":"Recommendations (".concat((null===(h=e.recommendations)||void 0===h?void 0:h.length)||0,")")}),c==="".concat(s,"-").concat(l,"-").concat(i)&&(0,n.jsxs)("div",{className:"pl-3 border-l-2 border-blue-100 mt-1",children:[(0,n.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Plan recommendations to add when this option is selected:"}),e.recommendations&&e.recommendations.length>0?(0,n.jsx)("ul",{className:"space-y-1 mb-2",children:e.recommendations.map((e,o)=>(0,n.jsxs)("li",{className:"flex items-center text-xs bg-blue-50 p-1 rounded",children:[(0,n.jsx)("span",{className:"inline-block px-1.5 py-0.5 bg-blue-100 text-blue-800 rounded mr-1.5",children:e.category}),(0,n.jsx)("span",{className:"flex-1 truncate",children:e.text}),(0,n.jsx)("button",{type:"button",onClick:()=>{let e=[...t.options||[]],n=[...e[i].recommendations||[]].filter((e,t)=>t!==o);e[i]={...e[i],recommendations:n},a("sections.".concat(s,".questions.").concat(l,".options"),e)},className:"ml-2 text-red-500",children:(0,n.jsx)(r.A,{className:"h-3 w-3"})})]},e.id))}):(0,n.jsx)("p",{className:"text-xs text-gray-400 italic mb-2",children:"No recommendations added yet"}),m==="".concat(s,"-").concat(l,"-").concat(i)?(0,n.jsxs)("div",{className:"bg-gray-50 p-1.5 rounded text-xs mb-2",children:[(0,n.jsx)("input",{type:"text",value:g.text,onChange:e=>p({...g,text:e.target.value}),className:"w-full p-1 border border-gray-300 rounded-md mb-1",placeholder:"Recommendation text..."}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("select",{value:g.category,onChange:e=>p({...g,category:e.target.value}),className:"text-xs flex-1 p-1 border border-gray-300 rounded-md",children:b.map(e=>(0,n.jsx)("option",{value:e,children:e},e))}),(0,n.jsxs)("div",{className:"ml-1",children:[(0,n.jsx)("button",{type:"button",onClick:()=>x(null),className:"px-1.5 py-1 border border-gray-300 rounded text-gray-500 mr-1",children:"Cancel"}),(0,n.jsx)("button",{type:"button",onClick:()=>{if(!g.text.trim())return;let e={id:(0,d.A)(),text:g.text.trim(),category:g.category},n=[...t.options||[]];n[i]={...n[i],recommendations:[...n[i].recommendations||[],e]},a("sections.".concat(s,".questions.").concat(l,".options"),n),p({text:"",category:b[0]}),x(null)},className:"px-1.5 py-1 bg-blue-600 text-white rounded",disabled:!g.text.trim(),children:"Add"})]})]})]}):(0,n.jsxs)("button",{type:"button",onClick:()=>x("".concat(s,"-").concat(l,"-").concat(i)),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center",children:[(0,n.jsx)(o.A,{className:"h-3 w-3 mr-1"}),"Add Recommendation"]})]})]},e.id)}),(0,n.jsxs)("button",{type:"button",onClick:()=>{let e={id:(0,d.A)(),text:"New Option",value:"option_".concat((t.options||[]).length+1),order:(t.options||[]).length,recommendations:[]};a("sections.".concat(s,".questions.").concat(l,".options"),[...t.options||[],e])},className:"mt-2 inline-flex items-center px-3 py-1.5 text-sm text-blue-600 hover:text-blue-800",children:[(0,n.jsx)(o.A,{className:"h-4 w-4 mr-1"}),"Add Option"]})]})]});if("SCALE"===t.type&&t.scaleConfig){var h,f;return(0,n.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Scale Configuration"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-600",children:"Minimum Value"}),(0,n.jsx)("input",{type:"number",value:t.scaleConfig.min,onChange:e=>{let s={...t.scaleConfig,min:parseInt(e.target.value)};a("questions.".concat(l,".scaleConfig"),s)},className:"mt-1 w-full px-2 py-1 text-sm border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-600",children:"Maximum Value"}),(0,n.jsx)("input",{type:"number",value:t.scaleConfig.max,onChange:e=>{let s={...t.scaleConfig,max:parseInt(e.target.value)};a("questions.".concat(l,".scaleConfig"),s)},className:"mt-1 w-full px-2 py-1 text-sm border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-600",children:"Step Size"}),(0,n.jsx)("input",{type:"number",value:t.scaleConfig.step,onChange:e=>{let s={...t.scaleConfig,step:parseInt(e.target.value)};a("questions.".concat(l,".scaleConfig"),s)},className:"mt-1 w-full px-2 py-1 text-sm border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-600",children:"Labels (Optional)"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2 mt-1",children:[(0,n.jsx)("input",{type:"text",placeholder:"Min Label",value:(null===(h=t.scaleConfig.labels)||void 0===h?void 0:h.min)||"",onChange:e=>{let s={...t.scaleConfig,labels:{...t.scaleConfig.labels,min:e.target.value}};a("questions.".concat(l,".scaleConfig"),s)},className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md"}),(0,n.jsx)("input",{type:"text",placeholder:"Max Label",value:(null===(f=t.scaleConfig.labels)||void 0===f?void 0:f.max)||"",onChange:e=>{let s={...t.scaleConfig,labels:{...t.scaleConfig.labels,max:e.target.value}};a("questions.".concat(l,".scaleConfig"),s)},className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md"})]})]})]})]})}return"MATRIX"===t.type&&t.matrixConfig?(0,n.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Matrix Configuration"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-600",children:"Rows"}),(0,n.jsxs)("div",{className:"mt-1 space-y-2",children:[t.matrixConfig.rows.map((e,s)=>(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("input",{type:"text",value:e,onChange:e=>{let n=[...t.matrixConfig.rows];n[s]=e.target.value;let i={...t.matrixConfig,rows:n};a("questions.".concat(l,".matrixConfig"),i)},className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded-md"}),(0,n.jsx)("button",{type:"button",onClick:()=>{let e=t.matrixConfig.rows.filter((e,t)=>t!==s),n={...t.matrixConfig,rows:e};a("questions.".concat(l,".matrixConfig"),n)},className:"text-red-600 hover:text-red-800",children:(0,n.jsx)(r.A,{className:"h-4 w-4"})})]},s)),(0,n.jsx)("button",{type:"button",onClick:()=>{let e={...t.matrixConfig,rows:[...t.matrixConfig.rows,"Row ".concat(t.matrixConfig.rows.length+1)]};a("questions.".concat(l,".matrixConfig"),e)},className:"text-sm text-blue-600 hover:text-blue-800",children:"Add Row"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-600",children:"Columns"}),(0,n.jsxs)("div",{className:"mt-1 space-y-2",children:[t.matrixConfig.columns.map((e,s)=>(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("input",{type:"text",value:e,onChange:e=>{let n=[...t.matrixConfig.columns];n[s]=e.target.value;let i={...t.matrixConfig,columns:n};a("questions.".concat(l,".matrixConfig"),i)},className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded-md"}),(0,n.jsx)("button",{type:"button",onClick:()=>{let e=t.matrixConfig.columns.filter((e,t)=>t!==s),n={...t.matrixConfig,columns:e};a("questions.".concat(l,".matrixConfig"),n)},className:"text-red-600 hover:text-red-800",children:(0,n.jsx)(r.A,{className:"h-4 w-4"})})]},s)),(0,n.jsx)("button",{type:"button",onClick:()=>{let e={...t.matrixConfig,columns:[...t.matrixConfig.columns,"Column ".concat(t.matrixConfig.columns.length+1)]};a("questions.".concat(l,".matrixConfig"),e)},className:"text-sm text-blue-600 hover:text-blue-800",children:"Add Column"})]})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",checked:t.matrixConfig.allowMultiple,onChange:e=>{let s={...t.matrixConfig,allowMultiple:e.target.checked};a("questions.".concat(l,".matrixConfig"),s)},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,n.jsx)("label",{className:"ml-2 text-sm text-gray-700",children:"Allow multiple selections per row"})]})]})]}):("VITAL_SIGNS"===t.type||"BMI_CALCULATOR"===t.type)&&t.vitalSignsConfig?(0,n.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Vital Signs Configuration"}),(0,n.jsxs)("div",{className:"space-y-4",children:[t.vitalSignsConfig.fields.map((e,s)=>(0,n.jsxs)("div",{className:"p-4 border border-gray-200 rounded-md",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsx)("h5",{className:"text-sm font-medium text-gray-700 capitalize",children:e.type.replace(/([A-Z])/g," $1").trim()}),(0,n.jsx)("button",{type:"button",onClick:()=>{let e=t.vitalSignsConfig.fields.filter((e,t)=>t!==s),n={...t.vitalSignsConfig,fields:e};a("questions.".concat(l,".vitalSignsConfig"),n)},className:"text-red-600 hover:text-red-800",children:(0,n.jsx)(r.A,{className:"h-4 w-4"})})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-600",children:"Unit"}),(0,n.jsx)("input",{type:"text",value:e.unit,onChange:n=>{let i=[...t.vitalSignsConfig.fields];i[s]={...e,unit:n.target.value};let o={...t.vitalSignsConfig,fields:i};a("questions.".concat(l,".vitalSignsConfig"),o)},className:"mt-1 w-full px-2 py-1 text-sm border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-600",children:"Required"}),(0,n.jsx)("div",{className:"mt-1",children:(0,n.jsx)("input",{type:"checkbox",checked:e.required,onChange:n=>{let i=[...t.vitalSignsConfig.fields];i[s]={...e,required:n.target.checked};let o={...t.vitalSignsConfig,fields:i};a("questions.".concat(l,".vitalSignsConfig"),o)},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-600",children:"Minimum Value"}),(0,n.jsx)("input",{type:"number",value:e.min||"",onChange:n=>{let i=[...t.vitalSignsConfig.fields];i[s]={...e,min:n.target.value?parseFloat(n.target.value):void 0};let o={...t.vitalSignsConfig,fields:i};a("questions.".concat(l,".vitalSignsConfig"),o)},className:"mt-1 w-full px-2 py-1 text-sm border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-600",children:"Maximum Value"}),(0,n.jsx)("input",{type:"number",value:e.max||"",onChange:n=>{let i=[...t.vitalSignsConfig.fields];i[s]={...e,max:n.target.value?parseFloat(n.target.value):void 0};let o={...t.vitalSignsConfig,fields:i};a("questions.".concat(l,".vitalSignsConfig"),o)},className:"mt-1 w-full px-2 py-1 text-sm border border-gray-300 rounded-md"})]})]})]},s)),(0,n.jsx)("button",{type:"button",onClick:()=>{let e={...t.vitalSignsConfig,fields:[...t.vitalSignsConfig.fields,{type:"temperature",unit:"\xb0F",required:!0}]};a("questions.".concat(l,".vitalSignsConfig"),e)},className:"text-sm text-blue-600 hover:text-blue-800",children:"Add Vital Sign"})]})]}):"SCORING_SCALE"===t.type&&t.scoringScaleConfig?(0,n.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Scoring Scale Configuration"}),(0,n.jsx)("div",{className:"space-y-4",children:(0,n.jsxs)("div",{className:"text-center py-4",children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Scoring Scale Assessment"}),(0,n.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[t.scoringScaleConfig.options.length," scoring options"]})]})})]}):null};var m=s(35695);let x=()=>Math.random().toString(36).substring(2,10),g=(e,t,s)=>{let n=Array.from(e),[i]=n.splice(t,1);return n.splice(s,0,i),n},p=[{value:"TEXT",label:"Short Text"},{value:"TEXTAREA",label:"Long Text"},{value:"SELECT",label:"Dropdown Select"},{value:"MULTISELECT",label:"Multi-Select"},{value:"CHECKBOX",label:"Checkbox"},{value:"RADIO",label:"Radio Button"},{value:"DATE",label:"Date Picker"},{value:"NUMBER",label:"Number Input"},{value:"SCALE",label:"Scale (0-10)"},{value:"MATRIX",label:"Matrix/Grid"},{value:"VITAL_SIGNS",label:"Vital Signs"},{value:"BMI_CALCULATOR",label:"BMI Calculator"},{value:"SCORING_SCALE",label:"Scoring Scale (e.g., PHQ-9)"}];function b(e){var t,s,d,b,h,f;let{initialTemplate:v,onSave:y}=e,j=(0,m.useRouter)(),[N,C]=(0,i.useState)(null),[S,w]=(0,i.useState)({}),[q,k]=(0,i.useState)(""),[A,E]=(0,i.useState)(null),T=(0,l.mN)({defaultValues:{id:x(),name:"",description:"",isActive:!0,sections:[]}}),{register:I,control:L,handleSubmit:R,watch:O,setValue:M,formState:{errors:D}}=T,{fields:_,append:P,remove:H,move:Q}=(0,l.jz)({control:L,name:"sections"}),V=O("sections");(0,i.useEffect)(()=>{if(v){console.log("Loading initial template:",v);let e={...v,id:v._id||v.id};Object.keys(e).forEach(t=>{M(t,e[t])}),e.sections&&e.sections.length>0?C(0):U()}},[v,M]);let U=()=>{P({id:x(),title:"Section ".concat(_.length+1),description:"",order:_.length,isActive:!0,questions:[]}),C(_.length),0===_.length&&setTimeout(()=>{B(0)},100)},B=e=>{let t=V[e].questions||[],s=[{id:x(),text:"Option 1",value:"option_1",order:0},{id:x(),text:"Option 2",value:"option_2",order:1},{id:x(),text:"Option 3",value:"option_3",order:2}],n={id:x(),text:"",type:"RADIO",options:s,order:t.length,isRequired:!1};M("sections.".concat(e,".questions"),[...t,n]),w({...S,[n.id]:!0})},F=e=>{w({...S,[e]:!S[e]})},X=(e,t)=>{let s=[...V[e].questions];s.splice(t,1),M("sections.".concat(e,".questions"),s)},G=(e,t,s)=>{let n=V[e].questions[t];switch(n.options=[],n.scaleConfig=void 0,n.matrixConfig=void 0,n.vitalSignsConfig=void 0,n.scoringScaleConfig=void 0,s){case"SCALE":n.scaleConfig={min:0,max:10,step:1,labels:{min:"Not at all",max:"Very much"}};break;case"MATRIX":n.matrixConfig={rows:["Row 1","Row 2"],columns:["Column 1","Column 2"],allowMultiple:!1};break;case"VITAL_SIGNS":n.vitalSignsConfig={fields:[{type:"temperature",unit:"\xb0F",min:95,max:105,required:!0},{type:"bloodPressure",unit:"mmHg",min:70,max:200,required:!0},{type:"heartRate",unit:"bpm",min:40,max:200,required:!0}]};break;case"SELECT":case"MULTISELECT":case"CHECKBOX":case"RADIO":n.options=[{id:x(),text:"Option 1",value:"option_1",order:0},{id:x(),text:"Option 2",value:"option_2",order:1}];break;default:n.options=[]}n.type=s,M("sections.".concat(e,".questions.").concat(t),n)},K=(0,i.useCallback)(e=>{if(e.name&&e.sections&&0!==e.sections.length){k("Saving...");try{y(e);let t=new Date;E(t),k("Last auto-saved at ".concat(t.toLocaleTimeString())),setTimeout(()=>{k("")},3e3)}catch(e){console.error("Auto-save failed:",e),k("Auto-save failed")}}},[y]);return(0,i.useEffect)(()=>{let e=T.watch(e=>{if(!e.name||v&&!A)return;let t=setTimeout(()=>{K(e)},3e4);return()=>clearTimeout(t)});return()=>e.unsubscribe()},[T,K,v,A]),(0,n.jsx)("div",{className:"flex flex-col space-y-8",children:(0,n.jsxs)("form",{onSubmit:R(e=>{let t=!1;if(0===e.sections.length){alert("Please add at least one section to your template.");return}e.sections.forEach((e,s)=>{if(!e.title||""===e.title.trim()){alert("Section ".concat(s+1," requires a title.")),t=!0;return}if(e.order=s,!e.questions||0===e.questions.length){alert('Section "'.concat(e.title,'" needs at least one question.')),t=!0;return}e.questions.forEach((s,n)=>{if(!s.text||""===s.text.trim()){alert("Question ".concat(n+1,' in section "').concat(e.title,'" requires text.')),t=!0;return}s.order=n,s.options||(s.options=[]),s.options.forEach((e,n)=>{if(!e.text||""===e.text.trim()){alert("Option ".concat(n+1,' in question "').concat(s.text,'" requires text.')),t=!0;return}e.order=n})})}),!t&&(console.log("Template data to save:",e),y(e))}),children:[(0,n.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow mb-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold",children:"Template Information"}),q&&(0,n.jsx)("span",{className:"text-sm text-gray-500 italic",children:q})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:["Template Name ",(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,n.jsx)("input",{id:"name",type:"text",...I("name",{required:"Template name is required"}),className:"w-full px-3 py-2 border ".concat(D.name?"border-red-500 bg-red-50":"border-gray-300"," rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500")}),D.name&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:D.name.message})]}),(0,n.jsx)("div",{children:(0,n.jsxs)("label",{htmlFor:"is-active",className:"flex items-center",children:[(0,n.jsx)("input",{id:"is-active",type:"checkbox",...I("isActive"),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,n.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Active Template"})]})}),(0,n.jsxs)("div",{className:"md:col-span-2",children:[(0,n.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,n.jsx)("textarea",{id:"description",...I("description"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]})]}),(0,n.jsx)(c.JY,{onDragEnd:e=>{if(!e.destination)return;let{source:t,destination:s,type:n}=e;if("section"===n)t.index!==s.index&&(Q(t.index,s.index),N===t.index?C(s.index):null!==N&&N>=Math.min(t.index,s.index)&&N<=Math.max(t.index,s.index)&&C(N<t.index?N+1:N-1));else if("question"===n){let n=parseInt(e.destination.droppableId.split("-")[1],10),i=g(V[n].questions,t.index,s.index);M("sections.".concat(n,".questions"),i)}},children:(0,n.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow mb-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold",children:"Template Sections"}),(0,n.jsxs)("button",{type:"button",onClick:U,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center",children:[(0,n.jsx)(o.A,{className:"h-5 w-5 mr-1"}),"Add Section"]})]}),0===_.length?(0,n.jsx)("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-md",children:(0,n.jsx)("p",{className:"text-gray-500",children:'No sections added yet. Click "Add Section" to begin building your template.'})}):(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,n.jsx)("div",{className:"md:col-span-1 border-r border-gray-200 pr-4",children:(0,n.jsx)(c.gL,{droppableId:"sections",type:"section",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,children:e=>(0,n.jsxs)("ul",{...e.droppableProps,ref:e.innerRef,className:"space-y-2",children:[_.map((e,t)=>(0,n.jsx)(c.sx,{draggableId:"section-".concat(e.id),index:t,isDragDisabled:!1,children:e=>{var s,i,l;return(0,n.jsxs)("li",{ref:e.innerRef,...e.draggableProps,className:"p-3 rounded-md cursor-pointer flex justify-between items-center group ".concat(N===t?"bg-blue-50 border border-blue-200":"bg-gray-50 hover:bg-gray-100"),onClick:()=>C(t),children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("span",{className:"font-medium",children:(null===(s=V[t])||void 0===s?void 0:s.title)||"Section ".concat(t+1)}),(0,n.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[(null===(l=V[t])||void 0===l?void 0:null===(i=l.questions)||void 0===i?void 0:i.length)||0," questions"]})]}),(0,n.jsx)("div",{className:"opacity-50 hover:opacity-100",...e.dragHandleProps,children:(0,n.jsx)(a.A,{className:"h-4 w-4 text-gray-500"})})]})}},e.id)),e.placeholder]})})}),(0,n.jsx)("div",{className:"md:col-span-3",children:null!==N&&(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("div",{className:"p-4 border border-gray-200 rounded-md",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Section Title ",(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,n.jsx)("input",{type:"text",...I("sections.".concat(N,".title"),{required:"Section title is required"}),className:"w-full px-3 py-2 border ".concat((null===(s=D.sections)||void 0===s?void 0:null===(t=s[N])||void 0===t?void 0:t.title)?"border-red-500 bg-red-50":"border-gray-300"," rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500")}),(null===(b=D.sections)||void 0===b?void 0:null===(d=b[N])||void 0===d?void 0:d.title)&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:null===(f=D.sections[N])||void 0===f?void 0:null===(h=f.title)||void 0===h?void 0:h.message})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Section Description"}),(0,n.jsx)("textarea",{...I("sections.".concat(N,".description")),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",id:"section-active-".concat(N),...I("sections.".concat(N,".isActive")),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,n.jsx)("label",{htmlFor:"section-active-".concat(N),className:"ml-2 text-sm text-gray-700",children:"Active"})]}),(0,n.jsx)("button",{type:"button",onClick:()=>H(N),className:"px-2 py-1 text-sm text-red-600 hover:text-red-800 focus:outline-none",children:"Delete Section"})]})]})}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-medium",children:"Questions"}),(0,n.jsxs)("button",{type:"button",onClick:()=>B(N),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center",children:[(0,n.jsx)(o.A,{className:"h-4 w-4 mr-1"}),"Add Question"]})]}),(0,n.jsx)(c.gL,{droppableId:"questions-".concat(N),type:"question",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,children:e=>{var t,s;return(0,n.jsxs)("div",{...e.droppableProps,ref:e.innerRef,className:"space-y-4",children:[null===(s=V[N])||void 0===s?void 0:null===(t=s.questions)||void 0===t?void 0:t.map((e,t)=>(0,n.jsx)(c.sx,{draggableId:"question-".concat(e.id),index:t,children:s=>{var i,l,o,c,d,m,x,g,b,h,f,v,y,j,C;return(0,n.jsxs)("div",{ref:s.innerRef,...s.draggableProps,className:"border border-gray-200 rounded-md overflow-hidden",children:[(0,n.jsxs)("div",{className:"bg-gray-50 p-3 flex justify-between items-center cursor-pointer",onClick:()=>F(e.id),children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"mr-2",...s.dragHandleProps,children:(0,n.jsx)(a.A,{className:"h-4 w-4 text-gray-500"})}),(0,n.jsx)("span",{className:"font-medium",children:e.text||"Question ".concat(t+1)})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:(null===(i=p.find(t=>t.value===e.type))||void 0===i?void 0:i.label)||e.type}),(0,n.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),X(N,t)},className:"text-red-500 hover:text-red-700",children:(0,n.jsx)(r.A,{className:"h-4 w-4"})})]})]}),S[e.id]&&(0,n.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Question Text ",(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,n.jsx)("input",{type:"text",...I("sections.".concat(N,".questions.").concat(t,".text"),{required:"Question text is required"}),className:"w-full px-3 py-2 border ".concat((null===(d=D.sections)||void 0===d?void 0:null===(c=d[N])||void 0===c?void 0:null===(o=c.questions)||void 0===o?void 0:null===(l=o[t])||void 0===l?void 0:l.text)?"border-red-500 bg-red-50":"border-gray-300"," rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500")}),(null===(b=D.sections)||void 0===b?void 0:null===(g=b[N])||void 0===g?void 0:null===(x=g.questions)||void 0===x?void 0:null===(m=x[t])||void 0===m?void 0:m.text)&&(0,n.jsx)("p",{className:"mt-1 text-sm text-red-600",children:null===(j=D.sections)||void 0===j?void 0:null===(y=j[N])||void 0===y?void 0:null===(v=y.questions)||void 0===v?void 0:null===(f=v[t])||void 0===f?void 0:null===(h=f.text)||void 0===h?void 0:h.message})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Type*"}),(0,n.jsx)("select",{...I("sections.".concat(N,".questions.").concat(t,".type")),onChange:e=>G(N,t,e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:p.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",id:"question-required-".concat(e.id),...I("sections.".concat(N,".questions.").concat(t,".isRequired")),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,n.jsx)("label",{htmlFor:"question-required-".concat(e.id),className:"ml-2 text-sm text-gray-700",children:"Required Question"})]})]}),(0,n.jsx)(u,{question:e,activeSection:N,questionIndex:t,setValue:M}),(0,n.jsxs)("div",{className:"mt-6 border-t border-gray-200 pt-4",children:[(0,n.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,n.jsx)("h4",{className:"text-md font-medium",children:"Skip Logic"})}),(0,n.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"Create rules to show or hide this question based on answers to previous questions."}),(0,n.jsx)("div",{className:"space-y-3",children:null===(C=e.skipLogicRules)||void 0===C?void 0:C.map((e,s)=>{let i=V.flatMap((e,s)=>s===N?e.questions.filter((e,s)=>s<t).map(e=>({...e,sectionIndex:s})):e.questions.map(e=>({...e,sectionIndex:s}))),l=i.find(t=>t.id===e.condition.questionId);return(0,n.jsxs)("div",{className:"border border-gray-200 rounded-md p-3",children:[(0,n.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,n.jsxs)("span",{className:"text-sm font-medium",children:["Rule ",s+1]})}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Source Question"}),(0,n.jsx)("select",{...I("sections.".concat(N,".questions.").concat(t,".skipLogicRules.").concat(s,".condition.questionId")),className:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:i.map(e=>(0,n.jsx)("option",{value:e.id,children:e.text||"Question ".concat(e.order+1)},e.id))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Operator"}),(0,n.jsxs)("select",{...I("sections.".concat(N,".questions.").concat(t,".skipLogicRules.").concat(s,".condition.operator")),className:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,n.jsx)("option",{value:"EQUALS",children:"Equals"}),(0,n.jsx)("option",{value:"NOT_EQUALS",children:"Not Equals"}),(0,n.jsx)("option",{value:"CONTAINS",children:"Contains"}),(0,n.jsx)("option",{value:"GREATER_THAN",children:"Greater Than"}),(0,n.jsx)("option",{value:"LESS_THAN",children:"Less Than"}),(0,n.jsx)("option",{value:"IS_ANSWERED",children:"Is Answered"}),(0,n.jsx)("option",{value:"IS_NOT_ANSWERED",children:"Is Not Answered"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Value"}),l&&["RADIO","SELECT","MULTISELECT","CHECKBOX"].includes(l.type)?(0,n.jsx)("select",{...I("sections.".concat(N,".questions.").concat(t,".skipLogicRules.").concat(s,".condition.value")),className:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:l.options.map(e=>(0,n.jsx)("option",{value:e.value,children:e.text},e.id))}):(0,n.jsx)("input",{type:"text",...I("sections.".concat(N,".questions.").concat(t,".skipLogicRules.").concat(s,".condition.value")),className:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:["IS_ANSWERED","IS_NOT_ANSWERED"].includes(e.condition.operator)})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mt-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Action"}),(0,n.jsxs)("select",{...I("sections.".concat(N,".questions.").concat(t,".skipLogicRules.").concat(s,".action")),className:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,n.jsx)("option",{value:"SHOW",children:"Show"}),(0,n.jsx)("option",{value:"HIDE",children:"Hide"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Target Type"}),(0,n.jsxs)("select",{...I("sections.".concat(N,".questions.").concat(t,".skipLogicRules.").concat(s,".targetType")),className:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,n.jsx)("option",{value:"QUESTION",children:"This Question"}),(0,n.jsx)("option",{value:"SECTION",children:"A Section"})]})]}),"SECTION"===e.targetType&&(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Target Section"}),(0,n.jsx)("select",{...I("sections.".concat(N,".questions.").concat(t,".skipLogicRules.").concat(s,".targetSectionId")),className:"w-full px-2 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:V.map((e,t)=>(0,n.jsx)("option",{value:e.id,children:e.title||"Section ".concat(t+1)},e.id))})]})]})]},e.id)})})]})]})})]})}},e.id)),e.placeholder]})}})]})]})})]})]})}),(0,n.jsxs)("div",{className:"mt-6 flex justify-end",children:[(0,n.jsx)("button",{type:"button",onClick:()=>{window.confirm("Are you sure you want to cancel? Any unsaved changes will be lost.")&&j.push("/templates")},className:"mr-4 px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),(0,n.jsx)("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Save Template"})]})]})})}}}]);