(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3843,9846],{8794:(e,t,a)=>{"use strict";a.d(t,{A:()=>c,AuthProvider:()=>u});var r=a(95155),s=a(12115),n=a(93004),i=a(35317),o=a(13843);let l=(0,s.createContext)({user:null,login:async()=>{throw Error("Not implemented")},signup:async()=>{throw Error("Not implemented")},logout:async()=>{throw Error("Not implemented")},loading:!0});function u(e){let{children:t}=e,[a,u]=(0,s.useState)(null),[c,d]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=(0,n.hg)(o.auth,e=>{u(e),d(!1)});return()=>e()},[]);let m=async(e,t)=>{try{let a=await (0,n.x9)(o.auth,e,t);return u(a.user),localStorage.setItem("last-login-email",e),a.user}catch(e){throw console.error("Login error:",e.code,e.message),e}},p=async(e,t,a)=>{try{let r=(await (0,n.eJ)(o.auth,t,a)).user;return await (0,n.r7)(r,{displayName:e}),await (0,i.BN)((0,i.H9)(o.db,"users",r.uid),{uid:r.uid,displayName:e,email:t,createdAt:new Date().toISOString()}),u(r),r}catch(e){throw console.error("Signup error:",e.code,e.message),e}},h=async()=>{try{await (0,n.CI)(o.auth),u(null)}catch(e){throw console.error("Logout error:",e.code,e.message),e}};return(0,r.jsx)(l.Provider,{value:{user:a,login:m,signup:p,logout:h,loading:c},children:t})}let c=()=>(0,s.useContext)(l)},13843:(e,t,a)=>{"use strict";let r;a.d(t,{auth:()=>o,db:()=>l});var s=a(23915),n=a(93004),i=a(35317);r=(0,s.Dk)().length?(0,s.Dk)()[0]:(0,s.Wp)({apiKey:"AIzaSyCUXDjtCkalFKkukgedZePOySwYLimkakM",authDomain:"new-awv-app.firebaseapp.com",projectId:"new-awv-app",storageBucket:"new-awv-app.firebasestorage.app",messagingSenderId:"466832878",appId:"1:466832878:web:504bb7a0b7de0705cad2ff"});let o=(0,n.xI)(r),l=(0,i.aU)(r)},17816:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var r=a(95155),s=a(12115),n=a(35695),i=a(8794),o=a(64219);function l(e){let{children:t,allowedRoles:a,fallbackUrl:l="/dashboard"}=e,{user:u}=(0,i.A)(),c=(0,n.useRouter)(),[d,m]=(0,s.useState)(null),[p,h]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{(async()=>{if(!u){c.push("/login");return}try{let e=await u.getIdToken(),t=await fetch("/api/users/profile",{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("Failed to fetch user profile");let r=await t.json(),s=a.includes(r.role);m(s),s||setTimeout(()=>{c.push(l)},1500)}catch(e){console.error("Authorization check failed:",e),m(!1),setTimeout(()=>{c.push(l)},1500)}finally{h(!1)}})()},[u,c,a,l]),p)?(0,r.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Checking permissions..."})]})}):!1===d?(0,r.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center max-w-md p-6 bg-white shadow-md rounded-lg",children:[(0,r.jsx)(o.A,{className:"h-16 w-16 text-red-500 mx-auto"}),(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mt-4",children:"Access Denied"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600",children:"You don't have permission to access this page. Redirecting..."})]})}):(0,r.jsx)(r.Fragment,{children:t})}var u=a(86798);function c(e){let{children:t}=e;return(0,r.jsx)(l,{allowedRoles:[u.g.ADMIN],fallbackUrl:"/settings",children:t})}},32822:(e,t,a)=>{Promise.resolve().then(a.bind(a,17816))},35695:(e,t,a)=>{"use strict";var r=a(18999);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},64219:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var r=a(12115);let s=r.forwardRef(function(e,t){let{title:a,titleId:s,...n}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":s},n),a?r.createElement("title",{id:s},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))})},86798:(e,t,a)=>{"use strict";a.d(t,{g:()=>s});var r=a(89644),s=function(e){return e.ADMIN="ADMIN",e.PROVIDER="PROVIDER",e.STAFF="STAFF",e.PATIENT="PATIENT",e.BILLING="BILLING",e.RESEARCHER="RESEARCHER",e}({});new r.Schema({firebaseUid:{type:String,required:!0,unique:!0},email:{type:String,required:!0,unique:!0},displayName:String,photoURL:String,role:{type:String,enum:Object.values(s),default:"PROVIDER"},specialty:String,organization:String,phoneNumber:String,npi:String,licenseNumber:String,licenseState:String,isActive:{type:Boolean,default:!0},permissions:{manageUsers:{type:Boolean,default:!1},manageTemplates:{type:Boolean,default:!1},viewReports:{type:Boolean,default:!1},createVisits:{type:Boolean,default:!0},editVisits:{type:Boolean,default:!0},deleteVisits:{type:Boolean,default:!1},managePatients:{type:Boolean,default:!0}},metadata:{lastLogin:Date,createdAt:Date,createdBy:{type:r.Schema.Types.ObjectId,ref:"User"},lastUpdated:Date,lastUpdatedBy:{type:r.Schema.Types.ObjectId,ref:"User"}},settings:{theme:{type:String,default:"light"},notifications:{email:{type:Boolean,default:!0},inApp:{type:Boolean,default:!0},sms:{type:Boolean,default:!1}},display:{compactView:{type:Boolean,default:!1},hideCompleted:{type:Boolean,default:!1},showTutorials:{type:Boolean,default:!0}}}},{timestamps:!0}).methods.hasPermission=function(e){return"ADMIN"===this.role||this.permissions&&!0===this.permissions[e]}}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,9192,6176,7131,9224,8441,1684,7358],()=>t(32822)),_N_E=e.O()}]);