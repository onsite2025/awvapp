(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2066,3843],{8794:(e,t,s)=>{"use strict";s.d(t,{A:()=>c,AuthProvider:()=>o});var a=s(95155),r=s(12115),l=s(93004),i=s(35317),n=s(13843);let d=(0,r.createContext)({user:null,login:async()=>{throw Error("Not implemented")},signup:async()=>{throw Error("Not implemented")},logout:async()=>{throw Error("Not implemented")},loading:!0});function o(e){let{children:t}=e,[s,o]=(0,r.useState)(null),[c,u]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=(0,l.hg)(n.auth,e=>{o(e),u(!1)});return()=>e()},[]);let h=async(e,t)=>{try{let s=await (0,l.x9)(n.auth,e,t);return o(s.user),localStorage.setItem("last-login-email",e),s.user}catch(e){throw console.error("Login error:",e.code,e.message),e}},p=async(e,t,s)=>{try{let a=(await (0,l.eJ)(n.auth,t,s)).user;return await (0,l.r7)(a,{displayName:e}),await (0,i.BN)((0,i.H9)(n.db,"users",a.uid),{uid:a.uid,displayName:e,email:t,createdAt:new Date().toISOString()}),o(a),a}catch(e){throw console.error("Signup error:",e.code,e.message),e}},m=async()=>{try{await (0,l.CI)(n.auth),o(null)}catch(e){throw console.error("Logout error:",e.code,e.message),e}};return(0,a.jsx)(d.Provider,{value:{user:s,login:h,signup:p,logout:m,loading:c},children:t})}let c=()=>(0,r.useContext)(d)},13843:(e,t,s)=>{"use strict";let a;s.d(t,{auth:()=>n,db:()=>d});var r=s(23915),l=s(93004),i=s(35317);a=(0,r.Dk)().length?(0,r.Dk)()[0]:(0,r.Wp)({apiKey:"AIzaSyCUXDjtCkalFKkukgedZePOySwYLimkakM",authDomain:"new-awv-app.firebaseapp.com",projectId:"new-awv-app",storageBucket:"new-awv-app.firebasestorage.app",messagingSenderId:"466832878",appId:"1:466832878:web:504bb7a0b7de0705cad2ff"});let n=(0,l.xI)(a),d=(0,i.aU)(a)},44985:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var a=s(95155),r=s(12115),l=s(8794);function i(){let{user:e}=(0,l.A)(),[t,i]=(0,r.useState)({}),[n,d]=(0,r.useState)(null),[o,c]=(0,r.useState)(null),[u,h]=(0,r.useState)(null),[p,m]=(0,r.useState)(!1),[x,g]=(0,r.useState)(""),[v,b]=(0,r.useState)("completed");(0,r.useEffect)(()=>{(async()=>{if(e)try{let{auth:e}=await Promise.resolve().then(s.bind(s,13843)),t=e.currentUser;if(t){let e=await t.getIdToken();i({Authorization:"Bearer ".concat(e)})}}catch(e){console.error("Error setting up auth:",e)}})()},[e]);let j=async()=>{m(!0),h(null);try{let e=await fetch("/api/visits",{headers:{...t}});if(!e.ok)throw Error("Error: ".concat(e.status," ").concat(e.statusText));let s=await e.json();console.log("API Response:",s),d(s),s&&s.length>0&&g(s[0].id||s[0]._id)}catch(e){h(e.message),console.error("API Error:",e)}finally{m(!1)}},w=async()=>{if(!x){h("Select a visit ID first");return}m(!0),h(null);try{let e=await fetch("/api/visits/".concat(x),{headers:{...t}});if(!e.ok)throw Error("Error fetching visit: ".concat(e.status," ").concat(e.statusText));let s=await e.json();console.log("Current visit:",s);let a={...s,status:v.toLowerCase()};console.log("Sending updated visit:",a);let r=await fetch("/api/visits/".concat(x),{method:"PUT",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(a)});if(!r.ok){let e=await r.text();throw Error("Update failed: ".concat(r.status," ").concat(e))}let l=await r.json();console.log("Update result:",l),c(l),j()}catch(e){h(e.message),console.error("Update error:",e)}finally{m(!1)}};return(0,a.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Visit API Test Tool"}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("button",{onClick:j,disabled:p,className:"bg-blue-500 text-white px-4 py-2 rounded mb-4",children:"Fetch All Visits"}),(0,a.jsxs)("div",{className:"mt-4 mb-6 border rounded p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Update Visit Status"}),(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)("input",{type:"text",value:x,onChange:e=>g(e.target.value),placeholder:"Visit ID",className:"border rounded p-2 mr-4 flex-grow"}),(0,a.jsxs)("select",{value:v,onChange:e=>b(e.target.value),className:"border rounded p-2 mr-4",children:[(0,a.jsx)("option",{value:"scheduled",children:"scheduled"}),(0,a.jsx)("option",{value:"in-progress",children:"in-progress"}),(0,a.jsx)("option",{value:"completed",children:"completed"}),(0,a.jsx)("option",{value:"cancelled",children:"cancelled"})]}),(0,a.jsx)("button",{onClick:w,disabled:p,className:"bg-green-500 text-white px-4 py-2 rounded",children:"Update Status"})]})]})]}),u&&(0,a.jsxs)("div",{className:"bg-red-100 text-red-700 p-4 rounded mb-6",children:[(0,a.jsx)("p",{className:"font-semibold",children:"Error:"}),(0,a.jsx)("p",{children:u})]}),p&&(0,a.jsx)("div",{className:"animate-pulse text-center p-4 mb-6",children:"Loading..."}),o&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Update Result"}),(0,a.jsxs)("div",{className:"bg-green-50 p-4 rounded",children:[(0,a.jsx)("p",{className:"font-medium",children:"Visit updated successfully:"}),(0,a.jsxs)("p",{children:["New status: ",(0,a.jsx)("span",{className:"font-semibold",children:o.status})]}),(0,a.jsxs)("p",{children:["Visit ID: ",o.id||o._id]}),(0,a.jsx)("pre",{className:"mt-2 text-xs bg-gray-100 p-2 rounded overflow-x-auto",children:JSON.stringify(o,null,2)})]})]}),n&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"All Visits"}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-x-6 gap-y-2 mb-4 text-sm font-medium",children:[(0,a.jsx)("div",{children:"Status"}),(0,a.jsx)("div",{children:"Patient"}),(0,a.jsx)("div",{children:"Date"}),(0,a.jsx)("div",{children:"ID"})]}),(0,a.jsx)("div",{className:"space-y-2",children:n.map(e=>(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-x-6 gap-y-1 border p-3 rounded hover:bg-gray-50",onClick:()=>g(e.id||e._id),children:[(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-semibold \n                    ".concat("completed"===e.status?"bg-green-100 text-green-800":"scheduled"===e.status?"bg-blue-100 text-blue-800":"in-progress"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status})}),(0,a.jsx)("div",{children:e.patientName}),(0,a.jsx)("div",{children:new Date(e.date).toLocaleString()}),(0,a.jsx)("div",{className:"text-xs text-gray-500 truncate",children:e.id||e._id})]},e.id||e._id))}),(0,a.jsxs)("div",{className:"mt-4 mb-2 text-sm text-gray-600",children:[(0,a.jsxs)("p",{children:["Total visits: ",n.length]}),(0,a.jsx)("p",{children:"Status breakdown:"}),(0,a.jsxs)("ul",{className:"list-disc pl-8",children:[(0,a.jsxs)("li",{children:["Scheduled: ",n.filter(e=>{var t;return(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())==="scheduled"}).length]}),(0,a.jsxs)("li",{children:["In Progress: ",n.filter(e=>{var t;return(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())==="in-progress"}).length]}),(0,a.jsxs)("li",{children:["Completed: ",n.filter(e=>{var t;return(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())==="completed"}).length]}),(0,a.jsxs)("li",{children:["Cancelled: ",n.filter(e=>{var t;return(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())==="cancelled"}).length]}),(0,a.jsxs)("li",{children:["Other status: ",n.filter(e=>{var t;return!["scheduled","in-progress","completed","cancelled"].includes(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())}).length]})]})]})]})]})}},97160:(e,t,s)=>{Promise.resolve().then(s.bind(s,44985))}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,9192,7131,9224,8441,1684,7358],()=>t(97160)),_N_E=e.O()}]);